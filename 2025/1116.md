# 🌱 TIL Day 2 — JOIN 방식에 따른 결과 차이 정리

## 📌 오늘의 핵심 개념
#### A쿼리 = INNER JOIN
- CATEGORY 기준이지만, 조인 조건을 만족하는 행만 조회됨
- 주문 이력 없는 카테고리는 결과에서 사라짐

#### B 쿼리 = LEFT JOIN
- CATEGORY 기준으로 모든 카테고리를 유지
- 매칭되는 상품/주문 없으면 NULL
- 집계 시 COALESCE로 NULL -> 0 변환 필요

## 예시 쿼리 비교

#### A.INNER JOIN 사용한 잘못된 접근
```sql
SELECT
    c.category_id,
    SUM(p.price * oi.quantity) AS total_sales_amount,
    SUM(oi.quantity) AS total_quantity
FROM CATEGORY c
JOIN PRODUCT p
  ON c.category_id = p.category_id
JOIN ORDER_ITEM oi
  ON p.product_id = oi.product_id
GROUP BY c.category_id;
```

#### 문제점
- 상품 없는 카테고리 -> 제외됨
- 주문 없는 상품만 있는 카테고리 -> 제외됨

#### B.LEFT JOIN 사용한 올바른 접근
```sql
SELECT
    c.category_id,
    c.category_name,
    COALESCE(SUM(p.price * oi.quantity), 0) AS total_sales_amount,
    COALESCE(SUM(oi.quantity), 0) AS total_quantity
FROM CATEGORY c
LEFT JOIN PRODUCT p
    ON p.category_id = c.category_id
LEFT JOIN ORDER_ITEM oi
    ON oi.product_id = p.product_id
GROUP BY
    c.category_id,
    c.category_name
ORDER BY
    c.category_id;
```

#### 핵심 포인트
- LEFT JOIN -> 기준 테이블인 CATEGORY는 항상 유지
- 매칭 없는 경우 -> NULL
- COALESCE -> NULL 을 0으로 안전하게 변환


## 📝 오늘 배운점

- 기준 테이블을 먼저 정한다
-   카테고리별 -> 기준 : CATEGORY
- 기준 테이블의 행을 모두 보여줘야 한다면 LEFT JOIN 선택
-   INNER JOIN 은 매칭 없는 데이터는 버림
- NULL 값은 COALESCE로 처리해 집계 정확도 확보
- JOIN 설계 순서는
-   1. 기준 테이블 선택
    2. 조인 방향 결정 (LEFT/INNER)
    3. 집계 시 NULL 처리
    4. GROUP BY 정리
